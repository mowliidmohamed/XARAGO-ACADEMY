<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Student Dashboard - Xarago Fashion Academy</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1>Welcome to Your Dashboard</h1>
    <p id="studentEmail"></p>
    <button id="logoutBtn" class="dashboard-btn">Logout</button>
  </header>

  <main class="dashboard">
    <!-- Profile Section -->
    <section class="profile">
      <h2>Your Profile</h2>
      <p>Name: Student Name</p>
      <p>Email: <span id="studentEmail"></span></p>
    </section>

    <!-- Courses Section -->
    <section class="courses">
      <h2>Your Courses</h2>
      <ul>
        <li>Loading courses...</li>
      </ul>
    </section>

    <!-- Progress Section -->
    <section class="progress">
      <h2>Progress Tracker</h2>
      <p>Pattern Making: 60% complete</p>
      <p>Digital CAD: 20% complete</p>
    </section>

    <!-- Announcements -->
    <section class="announcements">
      <h2>Announcements</h2>
      <p>ğŸ‰ New module on Draping Techniques released!</p>
    </section>
  </main>

  <!-- Firebase SDKs (compat versions) -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAntZ0xigv-91fR060PrJpdzOkNIEC4xvc",
      authDomain: "xarago-fashion-academy.firebaseapp.com",
      projectId: "xarago-fashion-academy",
      storageBucket: "xarago-fashion-academy.appspot.com",
      messagingSenderId: "477275067482",
      appId: "1:477275067482:web:72a5cadb56d2c34526b463",
      measurementId: "G-6X6WVMZ15K"
    };

    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // Protect dashboard
    auth.onAuthStateChanged(user => {
      if (!user) {
        window.location.href = "login.html";
      } else {
        document.getElementById("studentEmail").innerText = user.email;
      }
    });

    // Logout
    document.getElementById("logoutBtn").addEventListener("click", async () => {
      await auth.signOut();
      window.location.href = "login.html";
    });

    // Load courses.json
    document.addEventListener("DOMContentLoaded", async () => {
      const coursesContainer = document.querySelector(".courses ul");
      try {
        const response = await fetch("courses.json");
        const courses = await response.json();
        coursesContainer.innerHTML = "";
        courses.forEach(course => {
          const li = document.createElement("li");
          li.innerHTML = `
            <strong>${course.title}</strong> ($${course.price})<br>
            <a href="${course.materials.pdf}" target="_blank">ğŸ“„ PDF</a>
            <a href="${course.materials.quiz}" target="_blank">ğŸ“ Quiz</a>
            <ul>
              ${course.materials.modules.map(m => `<li>${m}</li>`).join("")}
            </ul>
          `;
          coursesContainer.appendChild(li);
        });
      } catch (err) {
        coursesContainer.innerHTML = "<p>âš ï¸ Could not load courses.</p>";
        console.error("Error loading courses.json:", err);
      }
    });
  </script>
</body>
</html>
